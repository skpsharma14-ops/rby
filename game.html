<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" href="./assets/img/story-sprouts-logo.svg">
<title>Read Now - Story Sprouts</title>
<meta name="description" content="Start reading now with Story Sprouts! A fun, free, and easy-to-read collection of books for kids.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/css/style.css" />
<style>
  body { margin:0; background:#000000; color:#ffffff; font-family:'Inter',sans-serif; }
  canvas { display:block; margin:60px auto; background:#1b1f29; border:4px solid #222832; }
  h1 { text-align:center; margin-top:20px; }
  p { text-align:center; }
</style>
</head>
<body>
<nav class="nav">
  <div class="container nav-inner">
    <a class="logo" href="index.html" aria-label="Home"><img src="./assets/img/story-sprouts-logo.svg" alt="Story Sprouts icon"><span>Story Sprouts</span></a>
    <div class="menu" data-nav-menu>
      <a href="index.html">Home</a>
      <a href="game.html" class="active">Read Now</a>
      <a href="leaderboard.html">Top Readers</a>
      <a href="about.html">About</a>
      <a href="blog.html">Blog</a>
      <a href="faq.html">FAQ</a>
      <a href="privacy.html">Privacy</a>
      <a href="terms.html">Terms</a>
    </div>
    <div class="right"><a class="btn ghost" data-nav-toggle>Menu</a><a class="btn" href="game.html">Read Now</a></div>
  </div>
</nav>

<h1>Story Sprouts Reader</h1>
<p>Use Left/Right arrow keys, or tap the sides of the book to turn pages!</p>
<canvas id="book-canvas" width="800" height="500"></canvas>

<script>
(function(){
  const canvas = document.getElementById('book-canvas');
  const ctx = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;

  // --- State ---
  const book = { 
    currentPage: 1, 
    totalPages: 10,
    booksRead: parseInt(localStorage.getItem('ss_booksRead') || '0') 
  };
  let isBookFinished = false;

  // --- Drawing Functions ---
  function drawBackground() {
    ctx.fillStyle = "#1b1f29";
    ctx.fillRect(0, 0, W, H);
  }

  function drawBook() {
    // Book cover/pages
    ctx.fillStyle = "#fff";
    ctx.fillRect(50, 50, W - 100, H - 100);
    
    // Page content
    ctx.fillStyle = "#000";
    ctx.font = "20px Inter";
    ctx.textAlign = "left";
    ctx.fillText(`This is page ${book.currentPage} of a wonderful story.`, 70, 100);
    ctx.fillText(`Imagine a beautiful illustration here!`, 70, 140);

    // Page number
    ctx.textAlign = "center";
    ctx.fillText(`${book.currentPage} / ${book.totalPages}`, W / 2, H - 20);
  }

  function drawEndScreen() {
    ctx.fillStyle = "rgba(27, 31, 41, 0.85)";
    ctx.fillRect(0, 0, W, H);
    ctx.fillStyle = "#fff";
    ctx.font = "32px Inter";
    ctx.textAlign = "center";
    ctx.fillText("The End! You've read " + book.booksRead + " book(s)!", W / 2, H / 2 - 20);
    ctx.font = "20px Inter";
    ctx.fillText("Click or press 'R' to Read Another", W / 2, H / 2 + 30);
  }

  function drawUI() {
    ctx.fillStyle = "#fff";
    ctx.font = "24px Inter";
    ctx.textAlign = "left";
    ctx.fillText("Books Read: " + book.booksRead, 20, 40);
  }

  function render() {
    drawBackground();
    drawBook();
    drawUI();
    if (isBookFinished) {
      drawEndScreen();
    }
  }

  // --- Logic ---
  function turnPage(direction) {
    if (isBookFinished) return;
    book.currentPage += direction;
    if (book.currentPage < 1) book.currentPage = 1;
    if (book.currentPage > book.totalPages) book.currentPage = book.totalPages;
    
    if (book.currentPage === book.totalPages) {
      isBookFinished = true;
      book.booksRead++;
      localStorage.setItem('ss_booksRead', book.booksRead);
      const lb = JSON.parse(localStorage.getItem('ss_leaderboard') || '[]');
      lb.push({ score: book.booksRead, at: Date.now() });
      lb.sort((a, b) => b.score - a.score);
      localStorage.setItem('ss_leaderboard', JSON.stringify(lb.slice(0, 50)));
    }
    render();
  }
  
  function readAnotherBook() {
    book.currentPage = 1;
    isBookFinished = false;
    render();
  }

  // --- Event Listeners ---
  window.addEventListener('keydown', e=>{
    if (isBookFinished) {
      if (e.key === 'r' || e.key === 'R') readAnotherBook();
      return;
    }
    if(e.key === "ArrowLeft") turnPage(-1);
    if(e.key === "ArrowRight") turnPage(1);
  });

  canvas.addEventListener('click', () => {
    if(isBookFinished) {
      readAnotherBook();
    }
  });

  // Initial render
  render();
})();
</script>
</body>
</html>
